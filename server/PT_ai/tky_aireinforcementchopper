//by tankbuster
 #include "..\includes.sqf"
_myscript = "tky_aireinforcementchopper";
__tky_starts;

params[
	["_helitype", selectRandom opfor_reinf_helos],// supply a classname or one will be chosen
	["_landingpos", cpt_position],// send a helipad object for accurate landing on it, else send a position
	["_cargocount", 99]// number of soldiers in cargo

	];
_startpos = cpt_position getPos [(4000 + random 3000), (random 360)];

_vecdata = [_startpos, (_startpos getdir cpt_position), _helitype, EAST] call BIS_fnc_spawnVehicle;

_helicargogroup = creategroup [east, true];
for "_n" from 1 to ((getNumber (configFile >> "CfgVehicles" >> _helitype >> "transportSoldier")) min _cargocount) do
	{
		_dude = _helicargogroup createUnit [(selectRandom opfor_heli_cargomen), _startpos, [],0, "NONE"];
		[_dude, true, true] call tky_fnc_tc_setskill;
		_dude moveInCargo (_vecdata select 0);
	};

(leader (_vecdata select 2)) doMove (if (typename _landingpos isEqualTo "OBJECT") then {getpos _landingpos} else {_landingpos});

while {((_vecdata select 0) distance2D _landingpos) > 20} do {sleep 3};
(_vecdata select 0) doStop;

if (typeName _landingpos isEqualTo "OBJECT") then {(_vec select 0) landAt _landingpos_} else {(_vec select 0) land "LAND"};

_helicargogroup leaveVehicle (_vecdata select 0);



__tky_ends